<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, viewport-fit=cover">
    <link rel="stylesheet" href="{{ "/css/navigation.css" | relative_url }}">
    <link rel="stylesheet" href="{{ "/css/post_display.css" | relative_url }}">
    {%- if site.paginate -%}
    <script>
      function next_page() {
        {%- if paginator.next_page %}
        window.location.href = '{{ paginator.next_page_path | relative_url }}'
        {%- endif -%}
      }
      function previous_page() {
        {%- if paginator.previous_page %}
        window.location.href = '{{ paginator.previous_page_path | relative_url }}'
        {%- endif -%}
      }
      function top_of_page_action (event) {
        switch (event.which || event.keyCode) {
          case 33: // Page Up
          case 37: // Left
          case 38: // Up
            previous_page();
            break;

          default:
            return; // Return, don't hit preventDefault()
        }
        event.preventDefault(); // Don't move page, if we reach here
      }
      function bottom_of_page_action(event) {
        switch (event.which || event.keyCode) {
          case 34: // Page Down
          case 39: // Right
          case 40: // Down
            next_page();
            break;

          default:
            return; // Return, don't hit preventDefault()
        }
        event.preventDefault(); // Don't move page, if we reach here
      }
      document.onkeydown = function (event) {
        event = event || window.event;
        if ((window.innerHeight + window.pageYOffset) >= document.body.offsetHeight) {
          bottom_of_page_action(event);
        }
        if (window.pageYOffset == 0) {
          top_of_page_action(event);
        }
      }
    </script>
    {%- endif -%}
  </head>
  <body>
    <nav class="site_nav" role="navigation">
      <ul class="nav_list">
        <!-- Site nav from _config.yml -->
        {%- for nav_target in site.navigation %}
        {%- if page.url == nav_target.url -%}
        <li class="current_item"><span title="Current Page">{{ nav_target.text }}</span></li>
        {%- else -%}
        <li class="nav_item"><a href="{{ nav_target.url | relative_url }}">{{ nav_target.text }}</a></li>
        {%- endif -%}
        {% endfor %}

        <!-- Pagination links -->
        {%- if site.paginate -%}
        <li class="dropdown">
          <a tabindex="0" href="javascript:void(0)">Post Indexes</a>
          <ul class="dropdown-content" aria-haspopup="true" aria-expanded="false">
            {%- for index_num in (1..paginator.total_pages) -%}
            {%- if paginator.page == index_num %}
            <li role="menuitem"><span>Index Page {{ index_num }}</span></li>
            {%- else %}
            {%- if index_num == 1 %}
            <li role="menuitem"><a href="{{ '/' | relative_url }}">Index Page {{ index_num }}</a></li>
            {%- else %}
            <li role="menuitem"><a href="{{ site.paginate_path | relative_url | replace: ':num', index_num }}">Index Page {{ index_num }}</a></li>
            {%- endif -%}
            {%- endif -%}
            {%- endfor %}
          </ul>
        </li>
        {%- endif -%}
      </ul>
    </nav>

    <div class="all_posts_container">
      {%- for post in paginator.posts %}
      <div class="single_post_container">
        <a href={{ post.permalink | relative_url }} class="link_no_format">
          <div class="opacity_workaround">
            <div class="bg_post_image" style="background: url({{ post.image | relative_url }});">
            </div>
            <div class="over_text">
              <span><b>Tags:</b> {{post.tags | join: ', ' | default: "None"}}</span><br/>
              <span><b>Categories:</b> {{post.categories | join: ', ' | default: "None"}}</span><br/>
              <span><b>Author:</b> {{post.author | default: "None"}}</span><br/>
              <span><b>Date:</b> {{post.date | date: "%B %d, %Y" | default: "None"}}</span>
              <p>{{- post | strip_html | truncatewords: 40 | strip -}} <em> Click for More</em></p>
            </div>
          </div>
          <h2>{{- post.title -}}</h2>
        </a>
      </div>
      {%- endfor %}
    </div>

    <!-- Pagination links -->
    {%- if site.paginate %}
    <div class="paginate">
      {%- if paginator.previous_page %}
      <a href="{{ paginator.previous_page_path | relative_url }}">Previous</a>
      {%- endif %}
      <span class="page_number ">Page: {{ paginator.page }} of {{ paginator.total_pages }}</span>
      {%- if paginator.next_page %}
      <a href="{{ paginator.next_page_path | relative_url }}">Next</a>
      {%- endif %}
    </div>
    {%- endif %}
  </body>
<html>
